<!DOCTYPE html>
<html lang="ar" dir="rtl">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
    <title>Score | ุณููุฑ - ุงูููุตุฉ ุงูุฃููู ููุชูุธูู ูุงูุณูุฑ ุงูุฐุงุชูุฉ</title>
    
    <!-- Lucide Icons -->
    <script src="https://unpkg.com/lucide@latest"></script>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>

    <!-- html2pdf.js REMOVED: Using native print for better Arabic support -->

    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    
    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@300;400;500;600;700;800&family=Noto+Naskh+Arabic:wght@400;500;600;700&display=swap" rel="stylesheet">
    
    <script>
      tailwind.config = {
        theme: {
          extend: {
            fontFamily: {
              sans: ['Cairo', 'sans-serif'],
              serif: ['Noto Naskh Arabic', 'serif'], // Better for detailed reading
            },
            colors: {
              dark: '#050505',
              card: '#121212',
              primary: '#7C3AED', 
              'primary-light': '#A78BFA',
              'primary-dark': '#5B21B6',
              secondary: '#E5E7EB',
              gold: '#F59E0B',
              'gold-light': '#FCD34D',
            },
            animation: {
              'fade-up': 'fadeUp 0.8s ease-out forwards',
              'fade-in': 'fadeIn 0.5s ease-out forwards',
              'pulse-slow': 'pulse 4s cubic-bezier(0.4, 0, 0.6, 1) infinite',
              'shimmer': 'shimmer 2s linear infinite',
            },
            keyframes: {
              fadeUp: {
                '0%': { opacity: '0', transform: 'translateY(20px)' },
                '100%': { opacity: '1', transform: 'translateY(0)' },
              },
              fadeIn: {
                '0%': { opacity: '0' },
                '100%': { opacity: '1' },
              },
              shimmer: {
                '0%': { backgroundPosition: '-1000px 0' },
                '100%': { backgroundPosition: '1000px 0' }
              }
            }
          }
        }
      }
    </script>
    <style>
      body {
        font-family: 'Cairo', sans-serif;
        background-color: #050505;
        color: #E5E7EB;
        overflow-x: hidden;
      }
      
      /* Premium Scrollbar */
      ::-webkit-scrollbar { width: 6px; }
      ::-webkit-scrollbar-track { background: #0A0A0A; }
      ::-webkit-scrollbar-thumb { background: #333; border-radius: 10px; }
      ::-webkit-scrollbar-thumb:hover { background: #7C3AED; }
      
      /* View Routing */
      .view-section {
        display: none;
        opacity: 0;
        animation: fadeIn 0.4s ease-out forwards;
      }
      .view-section.active {
        display: block;
        opacity: 1;
      }

      /* Loader */
      .loader {
        border: 3px solid rgba(255,255,255,0.1);
        border-radius: 50%;
        border-top: 3px solid #7C3AED;
        width: 24px;
        height: 24px;
        -webkit-animation: spin 1s linear infinite; /* Safari */
        animation: spin 1s linear infinite;
      }
      @keyframes spin {
        0% { transform: rotate(0deg); }
        100% { transform: rotate(360deg); }
      }

      /* Screen Preview Styles */
      .cv-paper {
        background: white;
        width: 210mm;
        min-height: 297mm;
        box-shadow: 0 0 40px rgba(0,0,0,0.5);
        color: black;
        overflow: hidden;
        position: relative;
        transform-origin: top center;
        margin: 0 auto;
        padding: 0; /* Control padding inside the renderer */
      }
      
      /* PRINT STYLES - Solves Arabic Font Issues */
      @media print {
        @page { margin: 0; size: auto; }
        body { background: white; color: black; }
        
        /* Hide everything except the CV */
        header, .view-section, #mobile-menu, #offer-modal, #ats-modal, #ai-loading, .no-print {
            display: none !important;
        }
        
        /* Show only the CV container */
        #view-builder { display: block !important; position: static !important; height: auto !important; overflow: visible !important; }
        #cv-wrapper { 
            transform: none !important; 
            box-shadow: none !important; 
            margin: 0 !important; 
            width: 100% !important;
            height: auto !important;
        }
        #preview-pane {
            display: block !important;
            position: static !important;
            padding: 0 !important;
            background: white !important;
        }
        .cv-paper {
            box-shadow: none !important;
            margin: 0 !important;
            width: 100% !important;
            page-break-after: auto;
        }
        
        /* Hide builder sidebar controls during print */
        .w-full.md\:w-\[45\%\].lg\:w-\[40\%\] { display: none !important; }
        .absolute.top-4.left-4 { display: none !important; } /* Hide download buttons on paper */
      }
      
      /* Glass Utility */
      .glass-panel {
        background: rgba(255, 255, 255, 0.03);
        backdrop-filter: blur(16px);
        -webkit-backdrop-filter: blur(16px);
        border: 1px solid rgba(255, 255, 255, 0.08);
      }
      
      /* Table Styles */
      .admin-table th { text-align: right; padding: 1rem; color: #9CA3AF; font-size: 0.875rem; border-bottom: 1px solid rgba(255,255,255,0.1); white-space: nowrap; }
      .admin-table td { padding: 1rem; border-bottom: 1px solid rgba(255,255,255,0.05); white-space: nowrap; }
      .admin-table tr:hover td { background-color: rgba(255,255,255,0.02); }
      
      /* Mobile Helpers */
      .mobile-only { display: block; }
      .desktop-only { display: none; }
      @media (min-width: 768px) {
        .mobile-only { display: none; }
        .desktop-only { display: block; }
      }
    </style>
  <script type="importmap">
{
  "imports": {
    "@google/genai": "https://esm.sh/@google/genai@^1.33.0",
    "react": "https://esm.sh/react@^19.2.3",
    "react-router-dom": "https://esm.sh/react-router-dom@^7.10.1",
    "lucide-react": "https://esm.sh/lucide-react@^0.561.0",
    "react/": "https://esm.sh/react@^19.2.3/",
    "framer-motion": "https://esm.sh/framer-motion@^12.23.26",
    "axios": "https://esm.sh/axios@^1.13.2"
  }
}
</script>
</head>
  <body class="bg-dark text-secondary selection:bg-primary selection:text-white flex flex-col min-h-screen">

    <!-- HEADER -->
    <header class="sticky top-0 z-50 bg-dark/80 backdrop-blur-xl border-b border-white/5 no-print">
        <div class="container mx-auto px-4 h-20 flex items-center justify-between">
          
          <!-- Logo -->
          <a href="#" onclick="app.navigate('home'); return false;" class="flex items-center gap-3 group">
            <div class="relative w-10 h-10 flex items-center justify-center bg-gradient-to-br from-primary to-indigo-600 rounded-xl shadow-lg shadow-primary/20 group-hover:rotate-12 transition-transform">
              <i data-lucide="star" class="w-6 h-6 text-white fill-white"></i>
            </div>
            <div class="flex flex-col">
              <span class="text-2xl font-black text-white tracking-tight">ุณููุฑ</span>
              <span class="text-[10px] text-primary-light font-bold uppercase tracking-[0.2em] -mt-1">Score CV</span>
            </div>
          </a>

          <!-- Desktop Nav -->
          <nav class="hidden md:flex items-center gap-1 bg-white/5 p-1 rounded-full border border-white/5">
            <a href="#" onclick="app.navigate('home'); return false;" class="nav-link px-5 py-2 rounded-full text-sm font-bold text-white bg-white/10 transition-all" data-target="home">ุงูุฑุฆูุณูุฉ</a>
            <a href="#" onclick="app.navigate('templates'); return false;" class="nav-link px-5 py-2 rounded-full text-sm font-medium text-gray-400 hover:text-white transition-all" data-target="templates">ุงูููุงูุจ</a>
            <a href="#" onclick="app.navigate('ai-start'); return false;" class="nav-link px-5 py-2 rounded-full text-sm font-medium text-purple-400 hover:text-purple-300 transition-all flex items-center gap-2" data-target="ai-start">
                <i data-lucide="sparkles" class="w-4 h-4"></i>
                ุตุงูุน ุงูุณูุฑุฉ
            </a>
            <a href="#" onclick="app.navigate('job-guarantee'); return false;" class="nav-link px-5 py-2 rounded-full text-sm font-medium text-amber-400 hover:text-amber-300 transition-all flex items-center gap-2" data-target="job-guarantee">
                <i data-lucide="crown" class="w-4 h-4"></i>
                ุงูุชูุธูู ุงููุถููู
            </a>
          </nav>

          <!-- Actions -->
          <div class="hidden md:flex items-center gap-4">
             <button id="header-auth-btn" onclick="app.navigate('auth')" class="text-sm font-medium text-gray-400 hover:text-white transition-colors">
                 ุชุณุฌูู ุงูุฏุฎูู
             </button>
             <button onclick="app.navigate('ai-start')" class="relative group bg-white text-dark px-6 py-2.5 rounded-xl font-bold hover:bg-gray-100 transition-all active:scale-95 flex items-center gap-2 shadow-[0_0_20px_rgba(255,255,255,0.1)]">
                 <span>ุงุตูุน ุณูุฑุชู ุจุงูุฐูุงุก</span>
                 <i data-lucide="bot" class="w-4 h-4 text-primary group-hover:rotate-12 transition-transform"></i>
             </button>
          </div>

          <!-- Mobile Toggle -->
          <button onclick="app.toggleMenu()" class="md:hidden p-3 bg-white/5 rounded-xl text-white">
            <i data-lucide="menu" class="w-6 h-6"></i>
          </button>
        </div>

        <!-- Mobile Menu -->
        <div id="mobile-menu" class="hidden fixed inset-0 z-50 bg-dark/95 backdrop-blur-xl pt-24 px-6 space-y-4 md:hidden animate-fade-in">
             <button onclick="app.toggleMenu()" class="absolute top-6 right-6 p-2 bg-white/10 rounded-full text-white"><i data-lucide="x"></i></button>
             <a href="#" onclick="app.navigate('home'); app.toggleMenu()" class="block text-2xl font-bold text-white py-4 border-b border-white/10">ุงูุฑุฆูุณูุฉ</a>
             <a href="#" onclick="app.navigate('ai-start'); app.toggleMenu()" class="block text-2xl font-bold text-purple-400 py-4 border-b border-white/10">ุจูุงุก ุจุงูุฐูุงุก ุงูุงุตุทูุงุนู โจ</a>
             <a href="#" onclick="app.navigate('templates'); app.toggleMenu()" class="block text-2xl font-bold text-white py-4 border-b border-white/10">ููุงูุจ ุงูุณูุฑุฉ</a>
             <a href="#" onclick="app.navigate('job-guarantee'); app.toggleMenu()" class="block text-2xl font-bold text-amber-400 py-4 border-b border-white/10">ุฎุฏูุฉ ุงูุชูุธูู <span class="text-xs bg-amber-500/20 px-2 py-1 rounded-full">Pro</span></a>
             <a href="#" onclick="app.navigate('dashboard'); app.toggleMenu()" class="block text-2xl font-bold text-white py-4 border-b border-white/10">ููุญุฉ ุงูุชุญูู</a>
             <button onclick="app.navigate('ai-start'); app.toggleMenu()" class="w-full mt-8 bg-primary text-white py-4 rounded-xl font-bold text-lg shadow-lg shadow-primary/40">ุงุจุฏุฃ ุงูุขู</button>
        </div>
    </header>

    <!-- APP CONTENT -->
    <main id="app-container" class="flex-grow relative z-10 overflow-hidden">
        
        <!-- PAGE: HOME -->
        <section id="view-home" class="view-section active">
            <!-- Hero -->
            <div class="relative pt-20 pb-32 lg:pt-32 overflow-hidden">
                <div class="absolute top-0 left-1/2 -translate-x-1/2 w-full h-full max-w-7xl pointer-events-none">
                   <div class="absolute top-0 left-1/4 w-[500px] h-[500px] bg-primary/20 rounded-full blur-[120px] animate-pulse-slow"></div>
                   <div class="absolute bottom-0 right-1/4 w-[500px] h-[500px] bg-blue-600/10 rounded-full blur-[120px]"></div>
                </div>

                <div class="container mx-auto px-4 relative z-10 text-center">
                    <div class="inline-flex items-center gap-2 bg-white/5 border border-white/10 backdrop-blur-md text-gray-300 px-4 py-1.5 rounded-full text-sm font-medium mb-8 shadow-2xl">
                      <span class="flex h-2 w-2 relative">
                        <span class="animate-ping absolute inline-flex h-full w-full rounded-full bg-green-400 opacity-75"></span>
                        <span class="relative inline-flex rounded-full h-2 w-2 bg-green-500"></span>
                      </span>
                      ูุฏุนูู ุจุฃุญุฏุซ ุชูููุงุช Gemini AI 2.5
                    </div>
                    
                    <h1 class="text-5xl md:text-7xl font-black text-white leading-tight mb-8 max-w-5xl mx-auto tracking-tight">
                      ุณูุฑุชู ุงูุฐุงุชูุฉ.. <br/>
                      <span class="text-transparent bg-clip-text bg-gradient-to-r from-primary to-indigo-400">ุจูุงุจุชู ููุดุฑูุงุช ุงูุนุงูููุฉ</span>
                    </h1>
                    
                    <p class="text-xl text-gray-400 mb-12 max-w-2xl mx-auto leading-relaxed">
                      ุฃูุดุฆ ุณูุฑุฉ ุฐุงุชูุฉ ุชุชุฌุงูุฒ ุฃูุธูุฉ ุงููุฑุฒ (ATS) ุจุฐูุงุก ุงุตุทูุงุนู ุฏููู. 
                      ูุญู ูุฑุชุจ ุฎุจุฑุงุชูุ ููุง ูุคูููุง.
                    </p>
                    
                    <div class="flex flex-col sm:flex-row items-center justify-center gap-4">
                      <button onclick="app.navigate('ai-start')" class="w-full sm:w-auto px-10 py-5 bg-gradient-to-r from-primary to-indigo-600 text-white text-lg font-bold rounded-2xl shadow-[0_0_40px_rgba(124,58,237,0.3)] hover:scale-105 transition-all active:scale-95 flex items-center justify-center gap-2">
                        <i data-lucide="sparkles" class="w-5 h-5 text-white"></i>
                        ุตูู ูู ุจุงูุฐูุงุก ุงูุงุตุทูุงุนู
                      </button>
                      <button onclick="app.navigate('templates')" class="w-full sm:w-auto px-10 py-5 bg-white/5 text-white border border-white/10 text-lg font-bold rounded-2xl hover:bg-white/10 transition-all flex items-center justify-center gap-2">
                           <i data-lucide="layout" class="w-5 h-5 text-gray-300"></i>
                           ุชุตูุญ ุงูููุงูุจ
                      </button>
                    </div>
                </div>
            </div>
        </section>

        <!-- PAGE: AI START -->
        <section id="view-ai-start" class="view-section">
            <div class="min-h-screen relative flex items-center justify-center overflow-hidden py-20">
                <!-- Background Ambient -->
                <div class="absolute inset-0 w-full h-full pointer-events-none">
                     <div class="absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-[600px] h-[600px] bg-primary/20 rounded-full blur-[120px] animate-pulse"></div>
                </div>

                <div class="container mx-auto px-4 relative z-10 max-w-3xl">
                    <div class="bg-card/80 backdrop-blur-xl border border-white/10 rounded-3xl p-8 md:p-12 shadow-2xl">
                        <div class="text-center mb-8">
                            <div class="inline-flex items-center justify-center w-16 h-16 rounded-2xl bg-gradient-to-br from-primary to-indigo-600 text-white mb-6 shadow-lg shadow-primary/30">
                                <i data-lucide="brain-circuit" class="w-8 h-8"></i>
                            </div>
                            <h1 class="text-3xl md:text-4xl font-black text-white mb-3">ุงูููุธู ุงูุฐูู ููุณูุฑ ุงูุฐุงุชูุฉ</h1>
                            <p class="text-gray-400 text-lg">
                                ูุง ุฏุงุนู ูููุก ุฎุงูุงุช ูุชุนุฏุฏุฉ. <br/> 
                                <span class="text-primary font-bold">ุงูุณุฎ ูุฃูุตู ูู ุดูุก ููุง</span> (ุงุณููุ ุฑูููุ ุฎุจุฑุงุชูุ ุชุนูููู) ุจุดูู ุนุดูุงุฆูุ ูุณูููู ุจุชุฑุชูุจู ูู ูู ุณูุฑุฉ ุฐุงุชูุฉ ุงุญุชุฑุงููุฉ ATS.
                            </p>
                        </div>

                        <div class="space-y-6">
                            
                            <div>
                                <label class="block text-white font-bold mb-2 flex items-center gap-2">
                                    <i data-lucide="file-text" class="w-4 h-4 text-primary"></i>
                                    ุงูุตู ุจูุงูุงุชู ููุง (ูุง ููู ุงูุชุฑุชูุจ)
                                </label>
                                <textarea id="ai-blob-input" rows="8" class="w-full bg-white/5 border border-white/10 rounded-xl p-4 text-white focus:border-primary outline-none transition-all placeholder-gray-600 leading-relaxed" placeholder="ูุซุงู:
ุฃูุง ูุญูุฏ ุฎุงูุฏุ ุฑูู ุฌูุงูู 0555555555
ุฎุฑูุฌ ุฌุงูุนุฉ ุงูููู ุณุนูุฏ ุฅุฏุงุฑุฉ ุฃุนูุงู 2020
ุงุดุชุบูุช ูู ุดุฑูุฉ ุฒูู ูุฎุฏูุฉ ุนููุงุก ูู 2021 ุงูู 2022
ูุจุนุฏูุง ูู ุงูุฑุงุฌุญู ุตุฑุงู ุฃูู ุงูู ุงูุงู
ููุงุฑุงุชู: ุงูุณูุ ุชูุงุตูุ ูุบุฉ ุงูุฌููุฒูุฉ ุฌูุฏุฉ..."></textarea>
                            </div>

                            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                <div>
                                    <label class="block text-white font-bold mb-2">ูุบุฉ ุงูุณูุฑุฉ ุงูุฐุงุชูุฉ</label>
                                    <div class="flex bg-white/5 p-1 rounded-xl">
                                        <button onclick="app.ai.setLang('ar')" id="btn-lang-ar" class="flex-1 py-2 rounded-lg text-sm font-bold bg-primary text-white transition-all">ุงูุนุฑุจูุฉ</button>
                                        <button onclick="app.ai.setLang('en')" id="btn-lang-en" class="flex-1 py-2 rounded-lg text-sm font-bold text-gray-400 hover:text-white transition-all">English</button>
                                    </div>
                                </div>
                                <div class="flex items-end">
                                     <div class="bg-yellow-500/10 border border-yellow-500/20 text-yellow-200 text-xs p-3 rounded-xl w-full">
                                         <i data-lucide="alert-circle" class="inline w-3 h-3 mb-1"></i>
                                         ุงูุฐูุงุก ุงูุงุตุทูุงุนู <strong>ูู ูุคูู</strong> ูุนูููุงุช ุบูุฑ ููุฌูุฏุฉ. ุชุฃูุฏ ูู ูุชุงุจุฉ ูู ุงูุชูุงุตูู ุงููููุฉ.
                                     </div>
                                </div>
                            </div>

                            <button onclick="app.ai.generate()" class="w-full py-4 bg-gradient-to-r from-primary to-indigo-600 hover:from-primary-light hover:to-primary text-white font-bold text-lg rounded-xl shadow-lg shadow-primary/30 transform hover:scale-[1.02] transition-all flex items-center justify-center gap-2">
                                <i data-lucide="wand-2" class="w-5 h-5"></i> ุชุญููู ูุจูุงุก ุงูุณูุฑุฉ ุงูุฐุงุชูุฉ
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- PAGE: TEMPLATES -->
        <section id="view-templates" class="view-section">
            <div class="container mx-auto px-4 py-20">
                <div class="text-center mb-16">
                    <h1 class="text-4xl font-black text-white mb-4">ููุงูุจ ATS ุงููุนุชูุฏุฉ</h1>
                    <p class="text-gray-400 text-lg">ุชุตุงููู ูุธููุฉ ููุงุถุญุฉ ุชุถูู ูุฑูุฑ ุณูุฑุชู ูู ุฃูุธูุฉ ุงููุฑุฒ ุงูุขูู</p>
                </div>
                <!-- Masonry Layout -->
                <div class="columns-1 md:columns-2 lg:columns-3 gap-8" id="templates-grid">
                    <!-- Dynamic Templates -->
                </div>
            </div>
        </section>

        <!-- PAGE: BUILDER -->
        <section id="view-builder" class="view-section">
            <div class="min-h-screen bg-[#0A0A0A] flex flex-col md:flex-row relative">
                
                <!-- Toggle Preview Button (Mobile) -->
                <button onclick="app.builder.togglePreview()" class="md:hidden fixed bottom-6 left-6 z-50 bg-primary text-white p-4 rounded-full shadow-2xl shadow-primary/50 animate-bounce no-print">
                    <i data-lucide="eye" class="w-6 h-6"></i>
                </button>

                <!-- Sidebar Form -->
                <div class="w-full md:w-[45%] lg:w-[40%] bg-dark border-l border-white/5 flex flex-col h-screen overflow-hidden no-print">
                    <div class="p-6 border-b border-white/5 flex flex-col gap-4 bg-dark z-20">
                        <div class="flex justify-between items-center">
                            <h2 class="font-bold text-white flex items-center gap-2"><i data-lucide="edit-3" class="w-4 h-4 text-primary"></i> ุงููุญุฑุฑ</h2>
                            <div class="flex gap-2">
                                <button onclick="app.navigate('ai-start')" class="text-xs bg-white/5 text-gray-400 px-3 py-2 rounded-lg hover:text-white flex items-center gap-1"><i data-lucide="rotate-ccw" class="w-3"></i> ุฅุนุงุฏุฉ ุงูุจูุงุก</button>
                            </div>
                        </div>
                    </div>

                    <!-- Steps Navigation -->
                    <div class="flex overflow-x-auto p-4 gap-2 border-b border-white/5 no-scrollbar">
                        <button onclick="app.builder.setStep(0)" id="step-btn-0" class="step-btn active whitespace-nowrap px-4 py-2 rounded-lg text-sm font-bold transition-all">ุงูุจูุงูุงุช</button>
                        <button onclick="app.builder.setStep(1)" id="step-btn-1" class="step-btn whitespace-nowrap px-4 py-2 rounded-lg text-sm font-bold transition-all">ุงูุฎุจุฑุงุช</button>
                        <button onclick="app.builder.setStep(2)" id="step-btn-2" class="step-btn whitespace-nowrap px-4 py-2 rounded-lg text-sm font-bold transition-all">ุงูุชุนููู</button>
                        <button onclick="app.builder.setStep(3)" id="step-btn-3" class="step-btn whitespace-nowrap px-4 py-2 rounded-lg text-sm font-bold transition-all">ุงูููุงุฑุงุช</button>
                    </div>

                    <!-- Form Content -->
                    <div class="flex-grow overflow-y-auto p-6 space-y-6 custom-scrollbar pb-32 md:pb-24">
                        
                        <!-- Step 0: Personal Info -->
                        <div id="step-content-0" class="step-content">
                            <div class="space-y-4">
                                <div><label class="block text-xs font-bold text-gray-500 mb-2">ุงูุงุณู ุงููุงูู</label><input type="text" id="inp-name" oninput="app.builder.updatePreview()" class="w-full bg-white/5 border border-white/10 rounded-xl p-3 text-white focus:border-primary outline-none" placeholder="ุงูุงุณู"></div>
                                <div><label class="block text-xs font-bold text-gray-500 mb-2">ุงููุณูู ุงููุธููู</label><input type="text" id="inp-title" oninput="app.builder.updatePreview()" class="w-full bg-white/5 border border-white/10 rounded-xl p-3 text-white focus:border-primary outline-none" placeholder="ูุซุงู: ูุฏูุฑ ูุดุงุฑูุน"></div>
                                <div class="grid grid-cols-2 gap-4">
                                    <div><label class="block text-xs font-bold text-gray-500 mb-2">ุงูุฅูููู</label><input type="email" id="inp-email" oninput="app.builder.updatePreview()" class="w-full bg-white/5 border border-white/10 rounded-xl p-3 text-white focus:border-primary outline-none text-left" dir="ltr" placeholder="Email"></div>
                                    <div><label class="block text-xs font-bold text-gray-500 mb-2">ุงูุฌูุงู</label><input type="text" id="inp-phone" oninput="app.builder.updatePreview()" class="w-full bg-white/5 border border-white/10 rounded-xl p-3 text-white focus:border-primary outline-none text-left" dir="ltr" placeholder="Phone"></div>
                                </div>
                                <div>
                                    <div class="flex justify-between mb-2"><label class="block text-xs font-bold text-gray-500">ุงูููุฎุต ุงููููู</label></div>
                                    <textarea id="inp-summary" oninput="app.builder.updatePreview()" rows="6" class="w-full bg-white/5 border border-white/10 rounded-xl p-3 text-white focus:border-primary outline-none leading-relaxed text-sm" placeholder="ุงูุชุจ ูุจุฐุฉ ูุฎุชุตุฑุฉ..."></textarea>
                                </div>
                            </div>
                        </div>

                        <!-- Step 1: Experience -->
                        <div id="step-content-1" class="step-content hidden">
                            <div class="bg-white/5 border border-white/5 rounded-xl p-4 mb-4">
                                <h4 class="font-bold text-white mb-2">ุงูุฎุจุฑุฉ ุงูุฃุฎูุฑุฉ</h4>
                                <input type="text" id="inp-exp-role" oninput="app.builder.updatePreview()" class="w-full bg-dark border border-white/10 rounded-lg p-3 text-sm text-white mb-2" placeholder="ุงููุณูู ุงููุธููู">
                                <input type="text" id="inp-exp-comp" oninput="app.builder.updatePreview()" class="w-full bg-dark border border-white/10 rounded-lg p-3 text-sm text-white mb-2" placeholder="ุงูุดุฑูุฉ">
                                <input type="text" id="inp-exp-date" oninput="app.builder.updatePreview()" class="w-full bg-dark border border-white/10 rounded-lg p-3 text-sm text-white mb-2" placeholder="ุงููุชุฑุฉ (ูุซุงู: 2020 - ุงูุขู)">
                                <textarea id="inp-exp-desc" oninput="app.builder.updatePreview()" rows="6" class="w-full bg-dark border border-white/10 rounded-lg p-3 text-sm text-white leading-relaxed" placeholder="ุงููุตู ูุงูููุงู..."></textarea>
                            </div>
                        </div>

                        <!-- Step 2: Education -->
                        <div id="step-content-2" class="step-content hidden">
                            <div class="bg-white/5 border border-white/5 rounded-xl p-4 mb-4">
                                <input type="text" id="inp-edu-deg" oninput="app.builder.updatePreview()" class="w-full bg-dark border border-white/10 rounded-lg p-3 text-sm text-white mb-2" placeholder="ุงูุฏุฑุฌุฉ ุงูุนูููุฉ">
                                <input type="text" id="inp-edu-uni" oninput="app.builder.updatePreview()" class="w-full bg-dark border border-white/10 rounded-lg p-3 text-sm text-white mb-2" placeholder="ุงูุฌุงูุนุฉ">
                                <input type="text" id="inp-edu-year" oninput="app.builder.updatePreview()" class="w-full bg-dark border border-white/10 rounded-lg p-3 text-sm text-white" placeholder="ุณูุฉ ุงูุชุฎุฑุฌ">
                            </div>
                        </div>

                        <!-- Step 3: Skills -->
                        <div id="step-content-3" class="step-content hidden">
                            <label class="block text-xs font-bold text-gray-500 mb-2">ุงูููุงุฑุงุช (ุงูุตู ุจูุงุตูุฉ)</label>
                            <textarea id="inp-skills" oninput="app.builder.updatePreview()" rows="6" class="w-full bg-white/5 border border-white/10 rounded-xl p-3 text-white focus:border-primary outline-none" placeholder="ููุงุฏุฉุ ุฅุฏุงุฑุฉ ููุชุ Excel..."></textarea>
                        </div>
                    </div>
                </div>

                <!-- Preview Pane (Responsive) -->
                <div id="preview-pane" class="hidden md:flex flex-col flex-grow bg-[#525659] items-center justify-center p-4 md:p-8 fixed inset-0 z-40 md:static">
                    <div class="absolute top-4 left-4 md:top-6 md:left-6 flex gap-2 z-50 no-print">
                         <button onclick="app.builder.togglePreview()" class="md:hidden bg-white/10 text-white p-2 rounded-full"><i data-lucide="x"></i></button>
                         <button onclick="window.print()" class="bg-primary hover:bg-primary-dark text-white px-6 py-2 rounded-lg font-bold shadow-lg shadow-primary/20 transition-all flex items-center gap-2">
                            <i data-lucide="printer" class="w-4 h-4"></i> <span class="hidden md:inline">ุทุจุงุนุฉ / PDF</span>
                         </button>
                    </div>

                    <!-- Dynamic Preview Container -->
                    <div id="cv-wrapper" class="origin-top shadow-2xl transition-all duration-300 mt-12 md:mt-0">
                        <div id="cv-preview" class="cv-paper">
                             <!-- Content injected via JS based on template -->
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- ADMIN DASHBOARD -->
        <section id="view-admin" class="view-section">
            <div class="min-h-screen bg-[#050505] flex flex-col md:flex-row">
                <!-- Sidebar -->
                <div class="w-full md:w-64 bg-card border-b md:border-b-0 md:border-l border-white/5 flex-shrink-0 flex md:flex-col justify-between md:justify-start">
                    <div class="p-4 md:p-6 border-b border-white/5 hidden md:block">
                        <h2 class="text-xl font-bold text-white flex items-center gap-2"><i data-lucide="shield" class="text-primary"></i> Admin</h2>
                    </div>
                    <nav class="p-4 flex md:flex-col gap-2 overflow-x-auto md:overflow-visible">
                        <button class="flex-shrink-0 md:w-full text-right p-3 rounded-xl bg-white/5 text-white font-bold flex items-center gap-3"><i data-lucide="users" class="w-5"></i> ุงููุดุชุฑููู</button>
                        <button class="flex-shrink-0 md:w-full text-right p-3 rounded-xl text-gray-400 hover:bg-white/5 transition-colors flex items-center gap-3"><i data-lucide="bar-chart" class="w-5"></i> ุงูุชูุงุฑูุฑ</button>
                    </nav>
                </div>

                <!-- Main Admin Content -->
                <div class="flex-1 p-4 md:p-8 overflow-y-auto">
                    <div class="flex justify-between items-center mb-8">
                        <h1 class="text-2xl md:text-3xl font-black text-white">ุฅุฏุงุฑุฉ ุทูุจุงุช ุงูุชูุธูู</h1>
                        <button onclick="app.navigate('home')" class="text-gray-500 hover:text-white text-sm">ุฎุฑูุฌ</button>
                    </div>

                    <!-- Admin Stats -->
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
                        <div class="bg-card border border-white/5 p-6 rounded-2xl">
                            <div class="text-gray-400 text-sm mb-1">ุฅุฌูุงูู ุงููุดุชุฑููู</div>
                            <div class="text-3xl font-bold text-white">1,240</div>
                        </div>
                        <div class="bg-card border border-white/5 p-6 rounded-2xl">
                            <div class="text-gray-400 text-sm mb-1">ุทูุจุงุช ูุดุทุฉ</div>
                            <div class="text-3xl font-bold text-amber-500">856</div>
                        </div>
                        <div class="bg-card border border-white/5 p-6 rounded-2xl">
                            <div class="text-gray-400 text-sm mb-1">ููุงุจูุงุช ูุฐุง ุงูุฃุณุจูุน</div>
                            <div class="text-3xl font-bold text-green-500">42</div>
                        </div>
                    </div>

                    <!-- Users Table -->
                    <div class="bg-card border border-white/5 rounded-2xl overflow-x-auto mb-8">
                        <table class="w-full admin-table text-right text-white min-w-[600px]">
                            <thead class="bg-white/5">
                                <tr>
                                    <th>ุงูุนููู</th>
                                    <th>ุงูุจุงูุฉ</th>
                                    <th>ุชุงุฑูุฎ ุงูุงุดุชุฑุงู</th>
                                    <th>ุงูุทูุจุงุช</th>
                                    <th>ุงูุฅุฌุฑุงุกุงุช</th>
                                </tr>
                            </thead>
                            <tbody id="admin-users-list">
                                <!-- Injected via JS -->
                            </tbody>
                        </table>
                    </div>

                    <!-- Job Management Panel (Hidden by default) -->
                    <div id="admin-job-manager" class="hidden bg-card border border-white/5 rounded-2xl p-6 animate-fade-in">
                        <div class="flex justify-between items-center mb-6">
                            <h2 class="text-xl font-bold text-white flex items-center gap-2">
                                <span class="w-3 h-3 rounded-full bg-green-500"></span>
                                ุฅุฏุงุฑุฉ: <span id="admin-selected-user" class="text-primary"></span>
                            </h2>
                            <button onclick="document.getElementById('admin-job-manager').classList.add('hidden')" class="text-gray-500 hover:text-white"><i data-lucide="x"></i></button>
                        </div>

                        <!-- Add Job Form -->
                        <div class="bg-white/5 p-4 rounded-xl mb-6 grid grid-cols-1 md:grid-cols-4 gap-3 items-end">
                            <div>
                                <label class="text-xs text-gray-400 block mb-1">ุงูุดุฑูุฉ</label>
                                <input type="text" id="admin-job-company" class="w-full bg-dark border border-white/10 rounded-lg p-2 text-sm text-white" placeholder="ุงุณู ุงูุดุฑูุฉ">
                            </div>
                            <div>
                                <label class="text-xs text-gray-400 block mb-1">ุงููุณูู ุงููุธููู</label>
                                <input type="text" id="admin-job-role" class="w-full bg-dark border border-white/10 rounded-lg p-2 text-sm text-white" placeholder="ุงููุณูู">
                            </div>
                            <div>
                                <label class="text-xs text-gray-400 block mb-1">ุงูุญุงูุฉ</label>
                                <select id="admin-job-status" class="w-full bg-dark border border-white/10 rounded-lg p-2 text-sm text-white">
                                    <option value="sent">ุชู ุงูุฅุฑุณุงู ๐จ</option>
                                    <option value="viewed">ุชูุช ุงููุดุงูุฏุฉ ๐</option>
                                    <option value="interview">ููุงุจูุฉ ๐ค</option>
                                    <option value="offer">ุนุฑุถ ูุธููู ๐</option>
                                </select>
                            </div>
                            <button onclick="app.admin.addJob()" class="bg-primary hover:bg-primary-dark text-white px-4 py-2 rounded-lg font-bold text-sm transition-all h-[38px]">ุฅุถุงูุฉ ุทูุจ</button>
                        </div>

                        <!-- User Jobs List -->
                        <div class="space-y-2" id="admin-user-jobs">
                            <!-- Injected -->
                        </div>
                    </div>
                </div>
            </div>
        </section>
        
        <section id="view-auth" class="view-section">
             <div class="min-h-screen bg-dark flex items-center justify-center p-4">
                 <div class="bg-card/50 p-8 rounded-2xl border border-white/10 text-center w-full max-w-md relative">
                     <h2 class="text-white text-xl font-bold mb-4">ุชุณุฌูู ุงูุฏุฎูู</h2>
                     <button onclick="app.auth.mockLogin('user')" class="w-full bg-primary text-white px-6 py-3 rounded-xl font-bold mb-3">ุฏุฎูู ูุดุชุฑู</button>
                     <button onclick="app.auth.mockLogin('admin')" class="w-full bg-gray-700 hover:bg-gray-600 text-white px-6 py-3 rounded-xl font-bold text-sm">ุฏุฎูู ุงููุงูู (Admin)</button>
                 </div>
             </div>
        </section>

        <!-- PAGE: JOB GUARANTEE -->
        <section id="view-job-guarantee" class="view-section">
            <div class="min-h-screen bg-[#050505] text-white font-sans overflow-x-hidden selection:bg-amber-500 selection:text-black">
                
                <!-- Ambient -->
                <div class="fixed inset-0 pointer-events-none">
                    <div class="absolute top-[-10%] left-[20%] w-[500px] h-[500px] bg-amber-600/10 rounded-full blur-[120px]"></div>
                </div>

                <!-- Hero -->
                <div class="relative pt-32 pb-24 lg:pt-40 lg:pb-32 overflow-hidden">
                    <div class="container mx-auto px-4 relative z-10 text-center">
                        <div class="inline-flex items-center gap-2 bg-[#1A1A1A] border border-amber-500/30 text-amber-400 px-5 py-2 rounded-full text-sm font-bold mb-8 shadow-[0_0_30px_rgba(245,158,11,0.15)] backdrop-blur-md">
                            <i data-lucide="shield-check" class="w-4 h-4"></i>
                            <span>ุงูุถูุงู ุงูุฐูุจู: ูุธููุฉ ุฃู ุงุณุชุฑุฏุงุฏ ุฃููุงูู</span>
                        </div>

                        <h1 class="text-5xl md:text-7xl lg:text-8xl font-black mb-6 leading-tight tracking-tight">
                            ูุง ุชุจุญุซ ุนู ูุธููุฉ... <br/>
                            <span class="text-transparent bg-clip-text bg-gradient-to-r from-amber-200 via-amber-500 to-amber-600 drop-shadow-2xl">ุฏุน ุงููุธููุฉ ุชุฌุฏู</span>
                        </h1>
                        
                        <p class="text-gray-400 text-lg md:text-2xl max-w-3xl mx-auto mb-12 leading-relaxed font-light">
                            ูุญู ูุง ูุณุงุนุฏู ูู ุงูุชูุฏูู ูุญุณุจุ ุจู ูููู ุจุงููููุฉ ููุงุจุฉ ุนูู.
                            <strong class="text-white font-bold block mt-2">ูุถูู ูู 3 ููุงุจูุงุช ุนูู ุฎูุงู 30 ูููุงูุ ุฃู ุชุณุชุฑุฏ ุงูู 199 ุฑูุงู ูุงููุฉ.</strong>
                        </p>

                        <div class="flex flex-col sm:flex-row items-center justify-center gap-4">
                            <a href="https://wa.me/966540673935?text=ุฃุฑุบุจ%20ูู%20ุงูุงุดุชุฑุงู%20ูู%20ุจุงูุฉ%20ุงูุชูุธูู%20ุงููุถูููุฉ%20ูู%20Score%20CV" target="_blank" class="w-full sm:w-auto">
                                <button class="w-full px-10 py-5 bg-gradient-to-r from-amber-500 to-amber-600 hover:from-amber-400 hover:to-amber-500 text-black font-black text-xl rounded-2xl shadow-[0_0_50px_rgba(245,158,11,0.3)] transition-all flex items-center justify-center gap-3 hover:scale-105 active:scale-95">
                                    ุงุดุชุฑู ุจู 199 ุฑูุงู <i data-lucide="arrow-left" class="w-6 h-6"></i>
                                </button>
                            </a>
                        </div>
                    </div>
                </div>

                <!-- Comparison -->
                <div class="py-24 bg-white/5 border-t border-white/5">
                    <div class="container mx-auto px-4 max-w-6xl">
                        <div class="text-center mb-16">
                            <h2 class="text-3xl font-bold text-white mb-4">ููุงุฐุง ุชูุดู ุงูุทุฑู ุงูุชูููุฏูุฉุ</h2>
                            <p class="text-gray-400 text-lg">ุงููุฑู ุจูู ูุนุงูุงุชู ุงูุญุงููุฉ ูุจูู ูุง ููุฏูู ูู</p>
                        </div>
                        <div class="grid md:grid-cols-2 gap-8 lg:gap-16 items-center">
                             <!-- Problem -->
                             <div class="bg-[#121212] rounded-3xl p-8 border border-white/5 hover:border-red-500/30 transition-colors">
                                 <h3 class="text-2xl font-bold text-gray-300 mb-8 flex items-center gap-3">
                                    <span class="bg-red-500/10 p-2 rounded-lg"><i data-lucide="x" class="text-red-500 w-6 h-6"></i></span>
                                    ุงูุทุฑููุฉ ุงูุชูููุฏูุฉ
                                 </h3>
                                 <ul class="space-y-6">
                                     <li class="flex gap-4 text-gray-400"><i data-lucide="x" class="text-red-900 w-6 h-6 shrink-0 mt-1"></i><div><strong class="block text-gray-300 mb-1">ุงูุชูุฏูู ุงููุฏูู ุงููุฑูู</strong>ุชุนุจุฆุฉ ููุณ ุงูุจูุงูุงุช ูุฆุงุช ุงููุฑุงุช.</div></li>
                                     <li class="flex gap-4 text-gray-400"><i data-lucide="x" class="text-red-900 w-6 h-6 shrink-0 mt-1"></i><div><strong class="block text-gray-300 mb-1">ุงูุฑูุถ ุงูุขูู (ATS)</strong>75% ุชุฑูุถ ูุจู ุฃู ูุฑุงูุง ุจุดุฑ.</div></li>
                                 </ul>
                             </div>
                             <!-- Solution -->
                             <div class="bg-gradient-to-br from-amber-900/10 to-[#121212] rounded-3xl p-8 border border-amber-500/30 transform md:scale-105 shadow-[0_0_50px_-10px_rgba(245,158,11,0.15)] relative">
                                 <div class="absolute top-0 right-0 bg-amber-500 text-black text-xs font-bold px-4 py-1 rounded-bl-xl">VIP</div>
                                 <h3 class="text-2xl font-bold text-white mb-8 flex items-center gap-3">
                                    <span class="bg-amber-500/20 p-2 rounded-lg"><i data-lucide="check" class="text-amber-500 w-6 h-6"></i></span>
                                    ูุน ุฎุฏูุฉ ุณููุฑ
                                 </h3>
                                 <ul class="space-y-6">
                                     <li class="flex gap-4 text-white"><i data-lucide="check" class="text-green-500 w-6 h-6 shrink-0 mt-1"></i><div><strong class="block text-white mb-1">ุฃุชูุชุฉ ูุงููุฉ</strong>ูุฑุณู ุณูุฑุชู ูู 100+ ุดุฑูุฉ ุฃุณุจูุนูุงู.</div></li>
                                     <li class="flex gap-4 text-white"><i data-lucide="check" class="text-green-500 w-6 h-6 shrink-0 mt-1"></i><div><strong class="block text-white mb-1">ูุตูู ูุจุงุดุฑ</strong>ุฑุณุงูุชู ุชุตู ููู Inbox ูุจุงุดุฑุฉ.</div></li>
                                 </ul>
                             </div>
                        </div>
                    </div>
                </div>

                <!-- Steps -->
                <div class="py-24 container mx-auto px-4">
                     <h2 class="text-4xl font-black text-center mb-20 text-white">ุฑุญูุชู ูู 4 ุฎุทูุงุช</h2>
                     <div class="grid md:grid-cols-2 lg:grid-cols-4 gap-8">
                          <div class="bg-[#151515] p-8 rounded-3xl border border-white/5 hover:border-amber-500/50 transition-all group hover:-translate-y-2">
                              <div class="text-4xl font-black text-white/5 mb-4 group-hover:text-amber-500/20">01</div>
                              <div class="w-12 h-12 bg-white/5 rounded-2xl flex items-center justify-center text-amber-500 mb-6 group-hover:bg-amber-500 group-hover:text-black transition-all"><i data-lucide="zap"></i></div>
                              <h3 class="text-xl font-bold text-white mb-3">ุงูุชุญููู ูุงูุชุฌููุฒ</h3>
                              <p class="text-gray-400 text-sm">ูุญูู ุฎุจุฑุงุคูุง ุณูุฑุชู ููุนูุฏูู ุตูุงุบุชูุง.</p>
                          </div>
                          <div class="bg-[#151515] p-8 rounded-3xl border border-white/5 hover:border-amber-500/50 transition-all group hover:-translate-y-2">
                              <div class="text-4xl font-black text-white/5 mb-4 group-hover:text-amber-500/20">02</div>
                              <div class="w-12 h-12 bg-white/5 rounded-2xl flex items-center justify-center text-amber-500 mb-6 group-hover:bg-amber-500 group-hover:text-black transition-all"><i data-lucide="target"></i></div>
                              <h3 class="text-xl font-bold text-white mb-3">ุงูุงุณุชูุฏุงู</h3>
                              <p class="text-gray-400 text-sm">ูุญุฏุฏ ุงูุดุฑูุงุช ุงูุชู ุชุจุญุซ ุนู ุชุฎุตุตู.</p>
                          </div>
                          <div class="bg-[#151515] p-8 rounded-3xl border border-white/5 hover:border-amber-500/50 transition-all group hover:-translate-y-2">
                              <div class="text-4xl font-black text-white/5 mb-4 group-hover:text-amber-500/20">03</div>
                              <div class="w-12 h-12 bg-white/5 rounded-2xl flex items-center justify-center text-amber-500 mb-6 group-hover:bg-amber-500 group-hover:text-black transition-all"><i data-lucide="send"></i></div>
                              <h3 class="text-xl font-bold text-white mb-3">ุงููุดุฑ</h3>
                              <p class="text-gray-400 text-sm">ุฅุฑุณุงู ูุจุงุดุฑ ููุฏุฑุงุก ุงูุชูุธูู.</p>
                          </div>
                          <div class="bg-[#151515] p-8 rounded-3xl border border-white/5 hover:border-amber-500/50 transition-all group hover:-translate-y-2">
                              <div class="text-4xl font-black text-white/5 mb-4 group-hover:text-amber-500/20">04</div>
                              <div class="w-12 h-12 bg-white/5 rounded-2xl flex items-center justify-center text-amber-500 mb-6 group-hover:bg-amber-500 group-hover:text-black transition-all"><i data-lucide="briefcase"></i></div>
                              <h3 class="text-xl font-bold text-white mb-3">ุงูููุงุจูุงุช</h3>
                              <p class="text-gray-400 text-sm">ุชุณุชูุจู ุงุชุตุงูุงุช ููููุงุจูุงุช.</p>
                          </div>
                     </div>
                </div>

                <!-- Guarantee Seal -->
                <div class="py-20 bg-amber-500 relative overflow-hidden">
                    <div class="container mx-auto px-4 relative z-10 flex flex-col md:flex-row items-center justify-between gap-12 text-center md:text-right">
                        <div class="flex-1">
                            <h2 class="text-4xl md:text-5xl font-black text-black mb-6">ุถูุงู ุงุณุชุฑุฌุงุน ุงูุฃููุงู 100%</h2>
                            <p class="text-black/80 text-xl font-medium leading-relaxed max-w-2xl">
                                ุฅุฐุง ูู ุชุญุตู ุนูู ุฃู ุชูุงุนู ูุธููู ุฎูุงู 30 ูููุงูุ ุณูุนูุฏ ูู ูุจูุบ 199 ุฑูุงู ููุฑุงู.
                            </p>
                        </div>
                        <div class="shrink-0">
                            <div class="w-64 h-64 border-8 border-black rounded-full flex items-center justify-center bg-white rotate-12 shadow-2xl">
                                <div class="text-center text-black">
                                    <div class="text-6xl font-black leading-none">30</div>
                                    <div class="text-xl font-bold uppercase">ููู</div>
                                    <div class="text-sm font-bold text-amber-600 mt-2">ุถูุงู ุฐูุจู</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- FAQ -->
                <div class="py-20 bg-white/5">
                    <div class="container mx-auto px-4 max-w-3xl">
                        <h2 class="text-3xl font-bold text-center mb-10 text-white">ุงูุฃุณุฆูุฉ ุงูุดุงุฆุนุฉ</h2>
                        <div class="space-y-4">
                            <div class="bg-black/40 rounded-2xl border border-white/5 overflow-hidden">
                                <button onclick="app.guarantee.toggleFaq(this)" class="w-full flex items-center justify-between p-6 text-right font-bold hover:bg-white/5 transition-colors text-lg text-white">
                                    <span>ููู ุชุถูููู ุงุณุชุฑุฏุงุฏ ุงููุจูุบุ</span>
                                    <i data-lucide="chevron-down" class="text-amber-500 transition-transform duration-300"></i>
                                </button>
                                <div class="hidden p-6 pt-0 text-gray-400 leading-relaxed border-t border-white/5 text-base">
                                    ูุชู ุชูุนูู ุนุฏุงุฏ 30 ูููุงู ูู ููุญุฉ ุงูุชุญูู. ุฅุฐุง ุงูุชูุช ุงููุฏุฉ ุฏูู ูุชุงุฆุฌุ ูุธูุฑ ุฒุฑ ุงุณุชุฑุฏุงุฏ ุงููุจูุบ ูุชุณุชุฑุฌุน ุฃููุงูู ููุฑุงู.
                                </div>
                            </div>
                            <div class="bg-black/40 rounded-2xl border border-white/5 overflow-hidden">
                                <button onclick="app.guarantee.toggleFaq(this)" class="w-full flex items-center justify-between p-6 text-right font-bold hover:bg-white/5 transition-colors text-lg text-white">
                                    <span>ูู ุงูุฎุฏูุฉ ุชุดูู ุฌููุน ุงูุชุฎุตุตุงุชุ</span>
                                    <i data-lucide="chevron-down" class="text-amber-500 transition-transform duration-300"></i>
                                </button>
                                <div class="hidden p-6 pt-0 text-gray-400 leading-relaxed border-t border-white/5 text-base">
                                    ูุนูุ ูุณุชูุฏู ุงูุดุฑูุงุช ุจูุงุกู ุนูู ูุณูุงู ุงููุธููู (ููุฏุณุฉุ ุฅุฏุงุฑุฉุ ุจุฑูุฌุฉุ ูุญุงุณุจุฉุ ุญุฏูุซู ุชุฎุฑุฌ) ูู ุงููุทุงุน ุงูุฎุงุต ูุดุจู ุงูุญูููู.
                                </div>
                            </div>
                            <div class="bg-black/40 rounded-2xl border border-white/5 overflow-hidden">
                                <button onclick="app.guarantee.toggleFaq(this)" class="w-full flex items-center justify-between p-6 text-right font-bold hover:bg-white/5 transition-colors text-lg text-white">
                                    <span>ููู ุชุตู ุณูุฑุชู ููุดุฑูุงุชุ</span>
                                    <i data-lucide="chevron-down" class="text-amber-500 transition-transform duration-300"></i>
                                </button>
                                <div class="hidden p-6 pt-0 text-gray-400 leading-relaxed border-t border-white/5 text-base">
                                    ูุณุชุฎุฏู ุชูููุฉ Direct Inboxing ูุฅุฑุณุงู ุณูุฑุชู ููุฃููุง ุฑุณุงูุฉ ุดุฎุตูุฉ ููู ูุจุฑูุฏ ูุฏูุฑ ุงูุชูุธููุ ููุง ูุถูู ูุณุจุฉ ูุชุญ ุนุงููุฉ ุฌุฏุงู.
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

            </div>
        </section>

    </main>

    <!-- OFFER MODAL -->
    <div id="offer-modal" class="hidden fixed inset-0 z-[100] bg-black/90 backdrop-blur-md flex items-center justify-center p-4 animate-fade-in no-print">
        <div class="bg-gradient-to-br from-[#1a1500] to-[#0a0a0a] border border-gold/30 w-full max-w-lg rounded-3xl p-1 relative overflow-hidden shadow-[0_0_50px_rgba(245,158,11,0.2)]">
            <div class="bg-[#0f0f0f] rounded-[22px] p-8 relative z-10">
                <button onclick="document.getElementById('offer-modal').classList.add('hidden')" class="absolute top-4 right-4 text-gray-500 hover:text-white"><i data-lucide="x"></i></button>
                <div class="text-center mb-6">
                    <div class="inline-flex items-center justify-center w-16 h-16 rounded-full bg-gold/10 text-gold mb-4 border border-gold/20 animate-pulse"><i data-lucide="rocket" class="w-8 h-8"></i></div>
                    <h2 class="text-3xl font-black text-white mb-2">ุชุฑููุฉ ุงูุญุณุงุจ</h2>
                    <p class="text-gray-400">ูุชุญููู ูุฐุง ุงููุงูุจ ุจุตูุบุฉ PDF ุนุงููุฉ ุงูุฌูุฏุฉ.</p>
                </div>
                <div class="flex gap-3">
                    <button onclick="alert('ุชู ุชุญูููู ูุจูุงุจุฉ ุงูุฏูุน')" class="flex-1 bg-gold hover:bg-yellow-500 text-black font-black py-4 rounded-xl shadow-lg shadow-gold/20">ุดุฑุงุก ุงููุงูุจ (29 ุฑูุงู)</button>
                    <button onclick="document.getElementById('offer-modal').classList.add('hidden')" class="px-4 text-gray-500 hover:text-white">ุฅูุบุงุก</button>
                </div>
            </div>
        </div>
    </div>

    <!-- ATS Modal -->
    <div id="ats-modal" class="hidden fixed inset-0 z-[60] bg-black/80 backdrop-blur-md flex items-center justify-center p-4 no-print">
         <div class="bg-[#151515] border border-white/10 rounded-3xl w-full max-w-md p-8 relative animate-fade-up">
             <button onclick="document.getElementById('ats-modal').classList.add('hidden')" class="absolute top-4 right-4 text-gray-500 hover:text-white"><i data-lucide="x"></i></button>
             <div class="text-center mb-6">
                 <div class="w-24 h-24 rounded-full border-[6px] border-green-500 flex items-center justify-center text-4xl font-black text-green-500 mx-auto mb-4 bg-green-500/10 shadow-[0_0_30px_rgba(34,197,94,0.2)]">92%</div>
                 <h2 class="text-2xl font-bold text-white">ูุชูุงูู ุชูุงูุงู!</h2>
                 <p class="text-gray-400 text-sm">ูุฐุง ุงููุงูุจ ูุตูู ููุนุจุฑ ุฃูุธูุฉ ุงููุฑุฒ ุจูุฌุงุญ.</p>
             </div>
             <button onclick="document.getElementById('ats-modal').classList.add('hidden')" class="w-full py-3 bg-white text-black font-bold rounded-xl hover:bg-gray-200">ูููุช</button>
         </div>
    </div>

    <!-- AI Writer Loading -->
    <div id="ai-loading" class="hidden fixed inset-0 z-[60] bg-black/90 flex items-center justify-center no-print">
         <div class="text-center">
             <div class="loader mx-auto mb-4"></div>
             <h2 id="ai-loading-text" class="text-xl font-bold text-white animate-pulse">ุงูุฐูุงุก ุงูุงุตุทูุงุนู ูุฑุชุจ ุณูุฑุชู...</h2>
         </div>
    </div>

    <!-- Logic -->
    <script type="module">
      import { GoogleGenAI } from "@google/genai";

      // Mock Database
      const db = {
          users: [
              { id: '1', name: 'ูุญูุฏ ุงูููุฏ', email: 'mohammed@example.com', plan: 'guaranteed', joinDate: '2024-02-01', applications: [
                  { id: 101, company: 'ุฃุฑุงููู', role: 'ูููุฏุณ ุจุชุฑูู', status: 'viewed', date: '2024-02-02' },
                  { id: 102, company: 'ุณุงุจู', role: 'ูููุฏุณ ุนูููุงุช', status: 'sent', date: '2024-02-05' }
              ]},
              { id: '2', name: 'ุณุงุฑุฉ ุงูุนูุฑู', email: 'sara@example.com', plan: 'pro', joinDate: '2024-02-10', applications: [] },
              { id: '3', name: 'ุฎุงูุฏ ุงูุณุงูู', email: 'khaled@example.com', plan: 'guaranteed', joinDate: '2024-02-15', applications: [
                  { id: 103, company: 'Riyad Bank', role: 'Data Analyst', status: 'interview', date: '2024-02-18' }
              ]}
          ]
      };

      window.app = {
        state: {
            lang: 'ar',
            currentUser: null, // 'admin' or 'user' (user is simulated as ID '1')
            template: 'classic',
            data: {
                name: "",
                title: "",
                email: "",
                phone: "",
                summary: "",
                exp: { role: "", comp: "", date: "", desc: "" },
                edu: { deg: "", uni: "", year: "" },
                skills: ""
            }
        },

        navigate: function(pageId) {
            document.querySelectorAll('.view-section').forEach(el => el.classList.remove('active'));
            const target = document.getElementById('view-' + pageId);
            if (target) {
                target.classList.add('active');
                window.scrollTo(0, 0);
                if(pageId === 'templates') this.renderTemplatesPage();
                if(pageId === 'admin') this.admin.renderUsers();
                if(pageId === 'jobs-tracking') this.tracking.render();
                
                // Refresh Icons when view changes
                if(typeof lucide !== 'undefined') {
                    setTimeout(() => lucide.createIcons(), 100);
                }
                
                // Dynamic Resize Trigger
                setTimeout(() => window.dispatchEvent(new Event('resize')), 100);
            }
        },

        toggleMenu: function() {
            const menu = document.getElementById('mobile-menu');
            if(menu) menu.classList.toggle('hidden');
        },

        // --- Admin Functions ---
        admin: {
            selectedUserId: null,

            renderUsers: function() {
                const tbody = document.getElementById('admin-users-list');
                if(!tbody) return;
                
                tbody.innerHTML = db.users.map(u => `
                    <tr class="cursor-pointer border-b border-white/5 hover:bg-white/5 transition-colors" onclick="app.admin.selectUser('${u.id}')">
                        <td class="p-4">
                            <div class="font-bold text-white">${u.name}</div>
                            <div class="text-xs text-gray-500">${u.email}</div>
                        </td>
                        <td class="p-4"><span class="text-xs px-2 py-1 rounded bg-white/10 text-gray-300 border border-white/10">${u.plan}</span></td>
                        <td class="p-4 text-gray-400 text-sm">${u.joinDate}</td>
                        <td class="p-4 text-center font-bold text-primary">${u.applications.length}</td>
                        <td class="p-4"><i data-lucide="chevron-left" class="text-gray-500"></i></td>
                    </tr>
                `).join('');
                if(typeof lucide !== 'undefined') lucide.createIcons();
            },

            selectUser: function(id) {
                this.selectedUserId = id;
                const user = db.users.find(u => u.id === id);
                if(!user) return;

                document.getElementById('admin-selected-user').innerText = user.name;
                document.getElementById('admin-job-manager').classList.remove('hidden');
                this.renderUserJobs(user);
            },

            renderUserJobs: function(user) {
                const container = document.getElementById('admin-user-jobs');
                container.innerHTML = user.applications.map(job => `
                    <div class="flex items-center justify-between bg-white/5 p-3 rounded-lg border border-white/5">
                        <div>
                            <div class="font-bold text-white text-sm">${job.company}</div>
                            <div class="text-xs text-gray-400">${job.role}</div>
                        </div>
                        <div class="flex items-center gap-2">
                            <select onchange="app.admin.updateJobStatus('${user.id}', ${job.id}, this.value)" class="bg-black text-xs text-gray-300 border border-white/10 rounded p-1">
                                <option value="sent" ${job.status === 'sent' ? 'selected' : ''}>ุชู ุงูุฅุฑุณุงู</option>
                                <option value="viewed" ${job.status === 'viewed' ? 'selected' : ''}>ุชูุช ุงููุดุงูุฏุฉ</option>
                                <option value="interview" ${job.status === 'interview' ? 'selected' : ''}>ููุงุจูุฉ</option>
                                <option value="offer" ${job.status === 'offer' ? 'selected' : ''}>ุนุฑุถ</option>
                            </select>
                            <button onclick="app.admin.deleteJob('${user.id}', ${job.id})" class="text-red-500 hover:text-red-400"><i data-lucide="trash-2" class="w-4 h-4"></i></button>
                        </div>
                    </div>
                `).join('');
                if(typeof lucide !== 'undefined') lucide.createIcons();
            },

            addJob: function() {
                if(!this.selectedUserId) return;
                const company = document.getElementById('admin-job-company').value;
                const role = document.getElementById('admin-job-role').value;
                const status = document.getElementById('admin-job-status').value;

                if(!company || !role) return alert('ุงูุจูุงูุงุช ูุงูุตุฉ');

                const user = db.users.find(u => u.id === this.selectedUserId);
                user.applications.unshift({
                    id: Date.now(),
                    company,
                    role,
                    status,
                    date: new Date().toLocaleDateString('ar-SA')
                });

                // Clear inputs
                document.getElementById('admin-job-company').value = '';
                document.getElementById('admin-job-role').value = '';
                
                this.renderUserJobs(user);
                this.renderUsers(); // Update counts
            },

            updateJobStatus: function(userId, jobId, newStatus) {
                const user = db.users.find(u => u.id === userId);
                const job = user.applications.find(j => j.id === jobId);
                if(job) job.status = newStatus;
            },

            deleteJob: function(userId, jobId) {
                const user = db.users.find(u => u.id === userId);
                user.applications = user.applications.filter(j => j.id !== jobId);
                this.renderUserJobs(user);
                this.renderUsers();
            }
        },

        // --- User Tracking Functions ---
        tracking: {
            render: function() {
                // Mock: Assume logged in user is ID '1' for demo
                const user = db.users.find(u => u.id === '1'); 
                if(!user) return;

                const statsGrid = document.getElementById('user-stats-grid');
                const jobsList = document.getElementById('user-jobs-list');

                // Calc Stats
                const sent = user.applications.length;
                const viewed = user.applications.filter(j => j.status === 'viewed').length;
                const interviews = user.applications.filter(j => j.status === 'interview').length;
                const offers = user.applications.filter(j => j.status === 'offer').length;

                statsGrid.innerHTML = `
                    <div class="bg-white/5 p-4 rounded-xl text-center border border-white/5">
                        <div class="text-2xl font-bold text-white mb-1">${sent}</div>
                        <div class="text-xs text-gray-400">ุฅุฑุณุงู</div>
                    </div>
                    <div class="bg-white/5 p-4 rounded-xl text-center border border-white/5">
                        <div class="text-2xl font-bold text-blue-400 mb-1">${viewed}</div>
                        <div class="text-xs text-gray-400">ูุดุงูุฏุฉ</div>
                    </div>
                    <div class="bg-white/5 p-4 rounded-xl text-center border border-white/5">
                        <div class="text-2xl font-bold text-purple-400 mb-1">${interviews}</div>
                        <div class="text-xs text-gray-400">ููุงุจูุฉ</div>
                    </div>
                    <div class="bg-white/5 p-4 rounded-xl text-center border border-white/5">
                        <div class="text-2xl font-bold text-green-400 mb-1">${offers}</div>
                        <div class="text-xs text-gray-400">ุนุฑุถ</div>
                    </div>
                `;

                const statusLabels = {
                    'sent': { text: 'ุชู ุงูุฅุฑุณุงู', color: 'text-gray-400 bg-gray-500/10' },
                    'viewed': { text: 'ุชูุช ุงููุดุงูุฏุฉ', color: 'text-blue-400 bg-blue-500/10' },
                    'interview': { text: 'ููุงุจูุฉ', color: 'text-purple-400 bg-purple-500/10' },
                    'offer': { text: 'ุนุฑุถ ูุธููู', color: 'text-green-400 bg-green-500/10' },
                };

                if(user.applications.length === 0) {
                    jobsList.innerHTML = '<div class="p-8 text-center text-gray-500">ุฌุงุฑู ุชุฌููุฒ ูุฅุฑุณุงู ุงูุทูุจุงุช...</div>';
                } else {
                    jobsList.innerHTML = user.applications.map(job => {
                        const s = statusLabels[job.status] || statusLabels['sent'];
                        return `
                        <div class="p-4 flex items-center justify-between hover:bg-white/5 transition-colors">
                            <div class="flex items-center gap-3">
                                <div class="w-10 h-10 rounded-full bg-white/5 border border-white/10 flex items-center justify-center font-bold text-gray-300">
                                    ${job.company.charAt(0)}
                                </div>
                                <div>
                                    <div class="font-bold text-white text-sm">${job.company}</div>
                                    <div class="text-xs text-gray-500">${job.role}</div>
                                </div>
                            </div>
                            <div class="text-right">
                                <span class="text-[10px] font-bold px-2 py-1 rounded ${s.color}">${s.text}</span>
                                <div class="text-[10px] text-gray-600 mt-1">${job.date}</div>
                            </div>
                        </div>
                    `}).join('');
                }
            }
        },

        // --- Premium Template Data ---
        templates: [
            { id: 'classic', name: 'ุงูุงุญุชุฑุงูู (ATS)', desc: 'ุงูุฃูุถู ููุดุฑูุงุช ุงูุญููููุฉ ูุงููุจุฑู. ูุชูุงูู 100%.', img: 'https://placehold.co/300x400/fff/000?text=Imperial+ATS', premium: true, price: '29 ุฑ.ุณ' },
            { id: 'modern', name: 'ุฃููููุณ (Corporate)', desc: 'ุชุตููู ุฌุงูุจู ุฃููู ูููุทุงุน ุงูุฎุงุต ูุงูุดุฑูุงุช ุงูุนุงูููุฉ.', img: 'https://placehold.co/300x400/1e293b/fff?text=Onyx+Pro', premium: true, price: '29 ุฑ.ุณ' },
            { id: 'creative', name: 'ูุงููุงุณ (Elite)', desc: 'ูููุจุฏุนููุ ุงููุตููููุ ูุงูุชุณููู. ุชุตููู ุฌุฐุงุจ ููุธูู.', img: 'https://placehold.co/300x400/7c3aed/fff?text=Canvas+Elite', premium: true, price: '29 ุฑ.ุณ' },
            { id: 'minimal', name: 'ุงูุจุณูุท (Clean)', desc: 'ุชุตููู ุจุณูุท ููุบุงูุฉ ูุฑูุฒ ุนูู ุงููุญุชูู ุจุฏูู ุชุดุชูุช.', img: 'https://placehold.co/300x400/f3f4f6/000?text=Clean+Minimal', premium: false, price: 'ูุฌุงูู' },
            { id: 'executive', name: 'ุงูุชูููุฐู (Executive)', desc: 'ูุซุงูู ูููุฏุฑุงุก ูุฃุตุญุงุจ ุงูุฎุจุฑุงุช ุงูุทูููุฉ.', img: 'https://placehold.co/300x400/0f172a/fff?text=Executive', premium: true, price: '49 ุฑ.ุณ' },
            { id: 'tech', name: 'ุชููู (DevOps)', desc: 'ุชุตููู ุฏุงูู ูููุจุฑูุฌูู ูุงููุทูุฑูู.', img: 'https://placehold.co/300x400/000/0f0?text=Dev+Terminal', premium: true, price: '29 ุฑ.ุณ' }
        ],

        renderTemplatesPage: function() {
            const grid = document.getElementById('templates-grid');
            if(grid) {
                grid.innerHTML = this.templates.map(t => `
                    <div class="break-inside-avoid mb-8 bg-white/5 border border-white/10 rounded-2xl overflow-hidden hover:border-primary/50 transition-all cursor-pointer group relative" onclick="app.builder.selectTemplate('${t.id}')">
                        ${t.premium ? '<div class="absolute top-4 left-4 z-10 bg-gold text-black text-xs font-bold px-3 py-1 rounded-full flex items-center gap-1 shadow-lg"><i data-lucide="crown" class="w-3 h-3"></i> Premium</div>' : '<div class="absolute top-4 left-4 z-10 bg-green-500 text-white text-xs font-bold px-3 py-1 rounded-full flex items-center gap-1 shadow-lg">ูุฌุงูู</div>'}
                        <div class="h-64 bg-gray-800 relative overflow-hidden">
                            <div class="absolute inset-0 bg-black/60 opacity-0 group-hover:opacity-100 transition-opacity flex flex-col items-center justify-center gap-2">
                                <span class="text-white font-bold text-lg">${t.name}</span>
                                <span class="bg-primary text-white px-6 py-2 rounded-full font-bold shadow-lg transform scale-90 group-hover:scale-100 transition-transform">ุงุณุชุฎุฏู ุงููุงูุจ</span>
                            </div>
                            <img src="${t.img}" class="w-full h-full object-cover opacity-80 group-hover:opacity-40 transition-all" />
                        </div>
                        <div class="p-6">
                            <div class="flex justify-between items-center mb-2">
                                <h3 class="text-xl font-bold text-white">${t.name}</h3>
                                <span class="text-gold font-bold">${t.price}</span>
                            </div>
                            <p class="text-gray-400 text-sm leading-relaxed">${t.desc}</p>
                        </div>
                    </div>
                `).join('');
                if(typeof lucide !== 'undefined') lucide.createIcons();
            }
        },
        
        guarantee: {
             toggleFaq: function(btn) {
                const answer = btn.nextElementSibling;
                const icon = btn.querySelector('[data-lucide="chevron-down"]');
                if(answer.classList.contains('hidden')) {
                    answer.classList.remove('hidden');
                    if(icon) icon.style.transform = 'rotate(180deg)';
                } else {
                    answer.classList.add('hidden');
                    if(icon) icon.style.transform = 'rotate(0deg)';
                }
             }
        },
        
        ai: {
            lang: 'ar',
            
            setLang: function(l) {
                this.lang = l;
                document.getElementById('btn-lang-ar').classList.toggle('bg-primary', l === 'ar');
                document.getElementById('btn-lang-ar').classList.toggle('text-white', l === 'ar');
                document.getElementById('btn-lang-ar').classList.toggle('text-gray-400', l !== 'ar');
                
                document.getElementById('btn-lang-en').classList.toggle('bg-primary', l === 'en');
                document.getElementById('btn-lang-en').classList.toggle('text-white', l === 'en');
                document.getElementById('btn-lang-en').classList.toggle('text-gray-400', l !== 'en');
            },

            generate: async function() {
                const rawText = document.getElementById('ai-blob-input').value;
                
                if(!rawText || rawText.length < 10) {
                    alert('ูุฑุฌู ูุชุงุจุฉ ุฃู ูุตู ุจูุงูุงุชู ูู ุงูุตูุฏูู');
                    return;
                }

                const loadingModal = document.getElementById('ai-loading');
                const loadingText = document.getElementById('ai-loading-text');
                loadingModal.classList.remove('hidden');
                
                try {
                    let generatedData;
                    
                    if (typeof process !== 'undefined' && process.env && process.env.API_KEY) {
                        loadingText.innerText = "ุฌุงุฑู ุชุญููู ุงูุจูุงูุงุช ูุงุณุชุฎุฑุงุฌ ุงููุนูููุงุช...";
                        const ai = new GoogleGenAI({ apiKey: process.env.API_KEY });
                        
                        // Strict Extraction Prompt
                        const prompt = `
                            You are a strict data extractor for a CV application.
                            Analyze the following unstructured text provided by a user:
                            "${rawText}"

                            Task: Extract the following fields into a valid JSON object.
                            Target Language for Output: ${this.lang === 'ar' ? 'Arabic' : 'English'}.
                            
                            Rules:
                            1. EXTRACT ONLY. Do not invent, hallucinate, or add any university, company, or experience not explicitly mentioned in the text.
                            2. If a field (like email or phone) is missing in the text, return an empty string "".
                            3. Format dates as "Year" or "Month Year" if available.
                            4. Format the 'summary' to be professional and ATS-friendly based ONLY on the provided skills and experience.
                            5. Structure the JSON exactly like this:
                            {
                              "name": "String",
                              "title": "String (Job Title)",
                              "email": "String",
                              "phone": "String",
                              "summary": "String",
                              "exp": {
                                "role": "String (Most recent job)",
                                "comp": "String (Company Name)",
                                "date": "String",
                                "desc": "String (Bullet points)"
                              },
                              "edu": {
                                "deg": "String (Degree)",
                                "uni": "String (University)",
                                "year": "String"
                              },
                              "skills": "String (Comma separated)"
                            }
                        `;
                        
                        const response = await ai.models.generateContent({
                            model: 'gemini-2.5-flash',
                            contents: prompt
                        });
                        
                        const text = response.text.replace(/```json|```/g, '').trim();
                        generatedData = JSON.parse(text);
                    } else {
                        // Fallback Simulation
                        await new Promise(r => setTimeout(r, 2000));
                        generatedData = this.getMockData(rawText);
                    }

                    this.finalizeGeneration(generatedData);

                } catch (error) {
                    console.error("AI Generation Error:", error);
                    const fallbackData = this.getMockData(rawText);
                    this.finalizeGeneration(fallbackData);
                }
            },

            getMockData: function(text) {
                return {
                    name: "ูุณุชุฎุฏู ุชุฌุฑูุจู",
                    title: "ูุฏูุฑ ูุดุงุฑูุน",
                    email: "user@example.com",
                    phone: "0500000000",
                    summary: "ูุฏูุฑ ูุดุงุฑูุน ุฐู ุฎุจุฑุฉ ูู ุฅุฏุงุฑุฉ ุงููุฑู ูุชุญููู ุงูุฃูุฏุงู ุงูุฒูููุฉ.",
                    exp: {
                        role: "ูุฏูุฑ ูุดุงุฑูุน",
                        comp: "ุดุฑูุฉ ุงูุชูููุฉ ุงููุชูุฏูุฉ",
                        date: "2022 - ุงูุขู",
                        desc: "โข ุฅุฏุงุฑุฉ ุงููุดุงุฑูุน ุงูุชูููุฉ.\nโข ุชุญุณูู ุณูุฑ ุงูุนูู."
                    },
                    edu: {
                        deg: "ุจูุงููุฑููุณ ุฅุฏุงุฑุฉ ุฃุนูุงู",
                        uni: "ุฌุงูุนุฉ ุงูููู ุณุนูุฏ",
                        year: "2020"
                    },
                    skills: "ุฅุฏุงุฑุฉ ูุดุงุฑูุน, ุชูุงุตู, ุชุฎุทูุท"
                };
            },

            finalizeGeneration: function(data) {
                app.state.data = data;
                app.state.lang = this.lang;
                
                // Update Inputs DOM
                const safeVal = (id, val) => { const el = document.getElementById(id); if(el) el.value = val || ''; };
                
                safeVal('inp-name', data.name);
                safeVal('inp-title', data.title);
                safeVal('inp-email', data.email);
                safeVal('inp-phone', data.phone);
                safeVal('inp-summary', data.summary);
                safeVal('inp-exp-role', data.exp?.role);
                safeVal('inp-exp-comp', data.exp?.comp);
                safeVal('inp-exp-date', data.exp?.date);
                safeVal('inp-exp-desc', data.exp?.desc);
                safeVal('inp-edu-deg', data.edu?.deg);
                safeVal('inp-edu-uni', data.edu?.uni);
                safeVal('inp-edu-year', data.edu?.year);
                safeVal('inp-skills', data.skills);

                // Set language in builder
                app.builder.setLanguage(this.lang);

                document.getElementById('ai-loading').classList.add('hidden');
                app.navigate('builder');
                app.builder.updatePreview();
            }
        },

        builder: {
            step: 0,
            isPreviewOpen: false,
            selectTemplate: function(id) {
                app.state.template = id;
                app.navigate('builder');
                this.updatePreview();
            },

            setStep: function(n) {
                this.step = n;
                document.querySelectorAll('.step-btn').forEach((btn, idx) => {
                    btn.classList.toggle('bg-primary', idx === n);
                    btn.classList.toggle('text-white', idx === n);
                    btn.classList.toggle('text-gray-400', idx !== n);
                });
                document.querySelectorAll('.step-content').forEach((el, idx) => {
                    el.classList.toggle('hidden', idx !== n);
                });
            },

            setLanguage: function(lang) {
                app.state.lang = lang;
                document.documentElement.dir = lang === 'ar' ? 'rtl' : 'ltr';
                this.updatePreview();
            },
            
            togglePreview: function() {
                this.isPreviewOpen = !this.isPreviewOpen;
                const pane = document.getElementById('preview-pane');
                if (this.isPreviewOpen) {
                    pane.classList.remove('hidden');
                    pane.classList.add('flex');
                } else {
                    pane.classList.add('hidden');
                    pane.classList.remove('flex');
                }
                // Trigger dynamic resize logic
                window.dispatchEvent(new Event('resize'));
            },

            updatePreview: function() {
                try {
                    const getValue = (id) => document.getElementById(id) ? document.getElementById(id).value : '';
                    app.state.data = {
                        name: getValue('inp-name'), title: getValue('inp-title'), email: getValue('inp-email'), phone: getValue('inp-phone'),
                        summary: getValue('inp-summary'),
                        exp: { role: getValue('inp-exp-role'), comp: getValue('inp-exp-comp'), date: getValue('inp-exp-date'), desc: getValue('inp-exp-desc') },
                        edu: { deg: getValue('inp-edu-deg'), uni: getValue('inp-edu-uni'), year: getValue('inp-edu-year') },
                        skills: getValue('inp-skills')
                    };

                    const container = document.getElementById('cv-preview');
                    if (!container) return;

                    const { data, lang, template } = app.state;
                    const isAr = lang === 'ar';
                    const dir = isAr ? 'rtl' : 'ltr';
                    
                    const L = {
                        summary: isAr ? 'ุงูููุฎุต ุงููููู' : 'Professional Summary',
                        exp: isAr ? 'ุงูุฎุจุฑุงุช ุงูุนูููุฉ' : 'Work Experience',
                        edu: isAr ? 'ุงูุชุนููู' : 'Education',
                        skills: isAr ? 'ุงูููุงุฑุงุช' : 'Skills',
                        contact: isAr ? 'ูุนูููุงุช ุงูุชูุงุตู' : 'Contact Info'
                    };

                    let html = '';

                    // --- 1. IMPERIAL ATS (Cleanest for Parsing) ---
                    // Default template for optimal ATS parsing
                    if (template === 'classic' || true) { 
                        html = `
                            <div class="h-full bg-white text-gray-900 p-12 ${isAr ? 'font-sans' : 'font-serif'}" dir="${dir}" style="line-height: 1.6;">
                                <header class="border-b-2 border-gray-800 pb-6 mb-8 text-center">
                                    <h1 class="text-4xl font-bold uppercase tracking-wide mb-2 text-gray-900">${data.name || (isAr?'ุงูุงุณู':'Your Name')}</h1>
                                    <p class="text-xl font-medium mb-4 text-gray-600 tracking-wide">${data.title || (isAr?'ุงููุณูู':'Job Title')}</p>
                                    <div class="flex justify-center flex-wrap gap-4 text-sm font-medium text-gray-600" dir="ltr">
                                        <span>${data.email}</span> 
                                        ${data.email && data.phone ? '<span class="text-gray-300">|</span>' : ''} 
                                        <span>${data.phone}</span>
                                    </div>
                                </header>
                                <section class="mb-8">
                                    <h3 class="font-bold text-lg uppercase border-b border-gray-300 mb-3 pb-1 tracking-wider text-gray-900">${L.summary}</h3>
                                    <p class="text-base leading-relaxed text-justify text-gray-800 font-normal">${data.summary}</p>
                                </section>
                                <section class="mb-8">
                                    <h3 class="font-bold text-lg uppercase border-b border-gray-300 mb-4 pb-1 tracking-wider text-gray-900">${L.exp}</h3>
                                    <div class="mb-5">
                                        <div class="flex justify-between items-baseline mb-1">
                                            <h4 class="font-bold text-lg text-gray-900">${data.exp.role}</h4>
                                            <span class="text-sm font-bold text-gray-700 bg-gray-100 px-3 py-1 rounded">${data.exp.date}</span>
                                        </div>
                                        <div class="text-base font-bold text-gray-600 mb-2 uppercase tracking-wide">${data.exp.comp}</div>
                                        <p class="text-sm text-gray-800 leading-relaxed whitespace-pre-line pl-2 border-l-2 border-gray-200">${data.exp.desc}</p>
                                    </div>
                                </section>
                                <section class="mb-8">
                                    <h3 class="font-bold text-lg uppercase border-b border-gray-300 mb-4 pb-1 tracking-wider text-gray-900">${L.edu}</h3>
                                    <div class="flex justify-between items-baseline">
                                        <div>
                                            <span class="font-bold text-lg block text-gray-900">${data.edu.deg}</span>
                                            <span class="text-base text-gray-700">${data.edu.uni}</span>
                                        </div>
                                        <span class="text-sm font-bold text-gray-700">${data.edu.year}</span>
                                    </div>
                                </section>
                                <section>
                                    <h3 class="font-bold text-lg uppercase border-b border-gray-300 mb-3 pb-1 tracking-wider text-gray-900">${L.skills}</h3>
                                    <div class="flex flex-wrap gap-2 text-sm text-gray-800 leading-7">
                                        ${data.skills.split(',').map(s=> s.trim() ? `<span class="bg-gray-100 px-3 py-1 rounded border border-gray-200 font-medium">${s.trim()}</span>` : '').join('')}
                                    </div>
                                </section>
                            </div>`;
                    }

                    container.innerHTML = html;
                    if(typeof lucide !== 'undefined') lucide.createIcons();

                } catch (e) {
                    console.error("Rendering error", e);
                }
            },

            analyzeATS: function() { 
                const modal = document.getElementById('ats-modal');
                if (modal) modal.classList.remove('hidden');
            }
        },

        auth: {
            mockLogin: function(role) {
                app.state.currentUser = role;
                if(role === 'admin') {
                    app.navigate('admin');
                } else {
                    app.navigate('dashboard');
                }
            }
        }
      };

      window.onload = function() {
          try {
              if(typeof lucide !== 'undefined') lucide.createIcons();
              app.navigate('home');
              app.builder.setStep(0);
              
              // Dynamic Scaling Logic
              function resizeCV() {
                  const wrapper = document.getElementById('cv-wrapper');
                  if (!wrapper) return;
                  
                  // Calculate scale based on viewport width
                  // Base width of A4 at 96DPI is approx 794px
                  const a4Width = 794; 
                  const screenWidth = window.innerWidth;
                  
                  // Add padding consideration
                  const availableWidth = screenWidth < 768 ? screenWidth - 32 : (screenWidth * 0.45) - 64; 
                  
                  // On mobile modal preview, use nearly full width
                  const isMobilePreview = document.getElementById('preview-pane') && !document.getElementById('preview-pane').classList.contains('hidden') && screenWidth < 768;
                  const targetWidth = isMobilePreview ? screenWidth - 32 : availableWidth;

                  let scale = targetWidth / a4Width;
                  
                  // Cap scale
                  if (scale > 1) scale = 1;
                  if (scale < 0.3) scale = 0.3; // Minimum legible scale
                  
                  // Set scale
                  wrapper.style.transform = `scale(${scale})`;
                  
                  // Adjust height of container to match scaled height
                  const scaledHeight = 1123 * scale;
                  wrapper.style.height = `${scaledHeight}px`;
                  wrapper.style.width = `${a4Width}px`; 
              }

              window.addEventListener('resize', resizeCV);
              // Initial call
              setInterval(resizeCV, 1000); 
              
          } catch(e) { console.error("App init failed", e); }
      };
    </script>
  </body>
</html>